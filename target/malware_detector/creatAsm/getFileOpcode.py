__author__ = 'ASUS'
# -*- coding:utf8 -*-
import re

def getOpcodeSequence(filename):

    allopcode = ['mov','movsx','movzx','push','pop','pusha','popa','pushad','popad','bswap','xchg','cmpxchg','xadd','xlat','in','out','lea','lds','les','lfs','lgs','lss','lahf','sahf','pushf','popf','pushd','popd','add','adc','inc','aaa','daa','sub','sbb','dec'\
                  'nec','cmp','aas','das','mul','imul','aam','div','idiv','aad','cbw','cwd','cwde','cdq','and','or','xor','not','test','shl','sal','shr','sar','rol','ror','rcl','rcr','movs','cmps','scas','lods','movsb','movsw','movsd','cmpsb','cmpsw','lodsb',\
                  'lodsw','lodsd','stos','rep','repe','repz','repne','repnz','repc','repnc','jmp','call','ret','retf','retn','ja','jnbe','jae','jnb','jb','jnae','jbe','jna','jg','jnle','jge','jnl','jl','jnge','jle','jng','je','jz','jne','jnz','jc','jnc','jno'\
                'jnp','jpo','jns','jo','jp','jpe','js','loop','loope','loopz','loopne','loopnz','jcxz','jecxz','int','into','iret','hlt','wait','esc','lock','nop','stc','clc','cmc','std','cld','sti','cli']
    opcodeList = []
    with open(filename,encoding='utf8',errors='ignore') as f:
        in_text = 0
        for line in f:
            temList = line.split()
            if temList:
                if temList[0] in allopcode:
                    opcodeList.append(temList[0])



    return opcodeList