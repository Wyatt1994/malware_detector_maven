package com.wyatt.learn08;

import java.io.*;

/**
 *  封装拷贝
 *  封装释放资源
 * Created by ASUS on 2018/10/18.
 */
public class FileUtils2 {
    public static void main(String[] args) {
        //文件到文件
        try {
            InputStream is=new FileInputStream("1.txt");
            OutputStream os=new FileOutputStream("1-copy.txt");
            copy(is,os);
        } catch (IOException e) {
            e.printStackTrace();
        }


        byte[] datas=null;
        //文件到字节数组
        try {
            InputStream is=new FileInputStream("1.png");
            ByteArrayOutputStream os=new ByteArrayOutputStream();
            copy(is,os);
            datas=os.toByteArray();
            System.out.println(datas.length);
        } catch (IOException e) {
            e.printStackTrace();
        }


        //字节数组到文件
        try {
            InputStream is=new ByteArrayInputStream(datas);
            OutputStream os=new FileOutputStream("p-copy.png");
            copy(is,os);
        } catch (IOException e) {
            e.printStackTrace();
        }

    }
    //使用try...with...resource
    //也就是把流的声明和实例化都放在try中，通知系统自动去释放，省去finally中的操作，详见TestCopyFile copy2方法
    public static void copy(InputStream iis, OutputStream oos) {
        try (InputStream is=iis;OutputStream os=oos) {
            //
            byte[] datas = new byte[1024];
            int len = -1;
            while ((len = is.read(datas)) != -1) {
                os.write(datas, 0, len);
            }
            os.flush();

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }


}
