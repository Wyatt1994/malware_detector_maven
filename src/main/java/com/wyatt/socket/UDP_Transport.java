package com.wyatt.socket;

import org.junit.Test;

import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;

/**
 * Created by ASUS on 2018/12/1.
 */
public class UDP_Transport {

    @Test
    public void udp_Send() throws Exception{

        DatagramSocket ds=new DatagramSocket();

        byte[] buf="i am udp".getBytes();
        DatagramPacket dp=new DatagramPacket(buf,buf.length,InetAddress.getByName("127.0.0.1"),9000);

        ds.send(dp);

        ds.close();

    }

    @Test
    public void udp_Receive()throws Exception{

        DatagramSocket ds=new DatagramSocket(9000);

        //定义一个定长无数据的数据包，用于存储收到的数据
        byte[] buf=new byte[1024];
        DatagramPacket dp=new DatagramPacket(buf,buf.length);

        //从ds接收数据包并写入dp
        ds.receive(dp);

        String ip=dp.getAddress().getHostAddress();
        String data=new String(dp.getData(),0,dp.getLength());
        int port=dp.getPort();

        System.out.println("收到udp数据包："+ip+"::"+data+"::"+port);

        ds.close();
    }
}
